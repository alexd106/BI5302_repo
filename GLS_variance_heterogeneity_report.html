<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Alex Douglas" />


<title>BI5302 Variance Heterogeneity Practical</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BI5302</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="exercises.html">
    <span class="fa fa-book"></span>
     
    Exercises
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://github.com/alexd106/BI5302_repo">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">BI5302 Variance Heterogeneity Practical</h1>
<h4 class="author">Alex Douglas</h4>
<h4 class="date">28 October, 2020</h4>

</div>


<p> </p>
<p>Setup global options for knitr package. Normally I wouldn’t display these but I’ll leave them here for your information. The arguments <code>width.cutoff</code> and <code>tidy = TRUE</code> keeps the displayed code within the code boxes (see what happens if you omit this).</p>
<p> </p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo=</span><span class="ot">TRUE</span>,<span class="dt">tidy.opts=</span><span class="kw">list</span>(<span class="dt">width.cutoff=</span><span class="dv">55</span>),<span class="dt">tidy=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div id="benthic-biodiversity-experiment" class="section level3">
<h3>Benthic Biodiversity experiment</h3>
<p>These data were obtained from a mesocosm experiment which aimed to examine the effect of benthic polychaete (<em>Hediste diversicolor</em>) biomass on sediment nutrient release (NH<sub>4</sub>, NO<sub>3</sub> and PO<sub>3</sub>). At the start of the experiment replicate mesocosms were filled with homogenised marine sediment and assigned to one of five polychaete biomass treatments (0, 0.5, 1, 1.5, 2 g per mesocosm). The mesocosms were allowed to acclimatise for 24 h after which the concentration of either NH<sub>4</sub>, NO<sub>3</sub> or PO<sub>3</sub> was measured in the water. The concentration of only one nutrient was measured in each mesocosm. The researchers were particularly interested in whether the nutrient concentration differed between polychaete biomass treatments and whether these effects were dependent on the nutrient.</p>
<p> </p>
<p>1. Create a new R markdown document in your BI5302 RStudio project and save it using a suitable file name. I suggest you specify the default output format as html but feel free to experiment with pdf (you can always change this later). Use this R markdown document to record your data exploration, statistical analysis (including graphs and tables) and commentary. For this exercise I would also suggest that you embed your R code as visible chunks within the document (use <code>echo = TRUE</code>) for later reference.</p>
<p> </p>
<p>Import all the packages required for this exercise:</p>
<p> </p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(nlme)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(effects)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(ggplot2)  <span class="co"># this is optional</span></span></code></pre></div>
<p> </p>
<p>2. Import the <code>Hediste.txt</code> dataset into R and assign it to a suitably named variable. Examine the structure of the dataframe and convert the <code>biomass</code> variable to a factors and store it as a new variable in your dataframe.</p>
<p> </p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>nereis &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/Hediste.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>nereis<span class="op">$</span>fbiomass &lt;-<span class="st"> </span><span class="kw">factor</span>(nereis<span class="op">$</span>biomass)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">str</span>(nereis)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">## &#39;data.frame&#39;:    45 obs. of  4 variables:</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">##  $ concentration: num  0.05 0.105 0.105 0.79 0.21 ...</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">##  $ biomass      : num  0 0 0 0.5 0.5 0.5 1 1 1 1.5 ...</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">##  $ fnutrient    : Factor w/ 3 levels &quot;NH4&quot;,&quot;NO3&quot;,&quot;PO3&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">##  $ fbiomass     : Factor w/ 5 levels &quot;0&quot;,&quot;0.5&quot;,&quot;1&quot;,..: 1 1 1 2 2 2 3 3 3 4 ...</span></span></code></pre></div>
<p> </p>
<p>3. How many replicates are there for each biomass and nutrient combination?</p>
<p> </p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">xtabs</span>(<span class="op">~</span>fbiomass <span class="op">+</span><span class="st"> </span>fnutrient, <span class="dt">data =</span> nereis)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">##         fnutrient</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">## fbiomass NH4 NO3 PO3</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">##      0     3   3   3</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">##      0.5   3   3   3</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">##      1     3   3   3</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">##      1.5   3   3   3</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">##      2     3   3   3</span></span></code></pre></div>
<p> </p>
<p>There are 3 replicates per <code>fbiomass</code> and <code>fnutrient</code> combination.</p>
<p> </p>
<p>4. Explore these data graphically. Are there any obvious outliers in the <code>concentration</code> variable for each of the <code>biomass</code> or <code>nutrient</code> variable levels (perhaps the <code>dotchart()</code> function with the <code>group</code> argument might help)? Use an appropriate plot to examine whether there are any biomass and/or nutrient effects on concentration (perhaps a boxplot?). Do you notice a potential issue regarding the between group variances?</p>
<p> </p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">dotchart</span>(nereis<span class="op">$</span>concentration, <span class="dt">groups =</span> nereis<span class="op">$</span>fnutrient, </span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="dt">col =</span> <span class="kw">as.numeric</span>(nereis<span class="op">$</span>fnutrient), <span class="dt">xlab =</span> <span class="st">&quot;Concentration&quot;</span>, </span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Order of observations&quot;</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/q4a-1.png" width="432" style="display: block; margin: auto;" /></p>
<p> </p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">dotchart</span>(nereis<span class="op">$</span>concentration, <span class="dt">groups =</span> nereis<span class="op">$</span>fbiomass, </span>
<span id="cb6-2"><a href="#cb6-2"></a>    <span class="dt">col =</span> <span class="kw">as.numeric</span>(nereis<span class="op">$</span>fbiomass), <span class="dt">xlab =</span> <span class="st">&quot;Concentration&quot;</span>, </span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Order of observations&quot;</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/q4b-1.png" width="432" style="display: block; margin: auto;" /></p>
<p> </p>
<p>There doesn’t appear to be any obvious outliers in the <code>concentration</code> variable for the <code>fbiomass</code> and <code>fnutrient</code> groups.</p>
<p>Are there any differences in concentration between the biomass treatment? Are these differences dependent on the type of nutrient? Let’s use a boxplot to explore this further (see the end of this document for an alternative approach to creating this boxplot using the <code>ggplot()</code> function).</p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">boxplot</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, <span class="dt">xlab =</span> <span class="st">&quot;biomass (g)&quot;</span>, </span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;concentration (mg/l)&quot;</span>, <span class="dt">data =</span> nereis, </span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="dt">cex.axis =</span> <span class="fl">0.8</span>, <span class="dt">col =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;yellowgreen&quot;</span>, </span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="st">&quot;deeppink3&quot;</span>), <span class="dt">each =</span> <span class="dv">5</span>), <span class="dt">names =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, </span>
<span id="cb7-5"><a href="#cb7-5"></a>        <span class="fl">1.5</span>, <span class="dv">2</span>), <span class="dv">3</span>))</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;yellowgreen&quot;</span>, </span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="st">&quot;deeppink3&quot;</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;NH4&quot;</span>, <span class="st">&quot;NO3&quot;</span>, <span class="st">&quot;PO3&quot;</span>), <span class="dt">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/q4c-1.png" width="576" style="display: block; margin: auto;" /></p>
<p> </p>
<p>There does appear to be a difference in the nutrient concentration between biomass treatments and this seems to be dependent on the nutrient type. Overall, NO<sub>3</sub> has the highest nutrient concentration compared to NH<sub>4</sub> and PO<sub>3</sub>. Nutrient concentration appears to be consistently low for PO<sub>3</sub> regardless of polychaete biomass whereas for NH<sub>4</sub> the concentration increases with biomass and for NO<sub>3</sub> the concentration decreases with an increase in biomass. This suggests that there is an interaction between biomass and nutrient type.</p>
<p> </p>
<p>5. With reference to the study aims stated above, fit an appropriate linear model to these data using the <code>lm()</code> function.</p>
<p> </p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>nereis.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>The code above fits a linear model using the <code>lm()</code> function with <code>concentration</code> as the response variable and <code>fbiomass</code> and <code>fnutrient</code> as explanatory variables. It also includes an interaction between <code>fbiomass</code> and <code>fnutrient</code>.</p>
<p> </p>
<p>6. Use appropriate residual plots to identify whether the modelling assumptions are met. Don’t forget to also plot the residuals from this model against all explanatory variables. Can you see a problem? Can you assume homogeneity of variance of the residuals from your model? If not, then try to identify the cause of this problem. Make sure you describe and discuss this process in your Rmarkdown document.</p>
<p> </p>
<p>First let’s create the usual residual plots using the <code>plot()</code> function on the <code>lm</code> model object <code>nereis.lm</code>. Don’t forget to split the plotting device into 2 rows and 2 columns so we can visualise all the plots together.</p>
<p> </p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">plot</span>(nereis.lm)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/q6-1.png" width="528" style="display: block; margin: auto;" /></p>
<p> </p>
<p>From the Residual vs Fitted and Scale-Location plots (left-hand side) you can clearly see that the residual variance is different for each of the treatment groups. Larger fitted values have a wider spread and small fitted values a narrower spread. This is a clear violation of the homogeneity of variance assumption!</p>
<p> </p>
<p>Let’s try to find which of the explanatory variable(s) is responsible for these differences in residual variance. First we plot the residuals from our linear model against the <code>fbiomass</code> variable.</p>
<p> </p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">plot</span>(<span class="kw">resid</span>(nereis.lm) <span class="op">~</span><span class="st"> </span>nereis<span class="op">$</span>fbiomass, <span class="dt">xlab =</span> <span class="st">&quot;Biomass&quot;</span>, </span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/unnamed-chunk-1-1.png" width="364.8" style="display: block; margin: auto;" /></p>
<p> </p>
<p>There are clear differences in the residual variance between each of the biomass levels. The zero biomass treatment has very little residual variance (as we might expect - why?) whereas the highest biomass group (2 g) has a very large within group variance. There are also differences between the other biomass groups but these are less pronounced.</p>
<p>We should also plot the residuals from our model against the <code>fnutrient</code> explanatory variable.</p>
<p> </p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">plot</span>(<span class="kw">resid</span>(nereis.lm) <span class="op">~</span><span class="st"> </span>nereis<span class="op">$</span>fnutrient, <span class="dt">xlab =</span> <span class="st">&quot;Nutrient&quot;</span>, </span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Residuals&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/unnamed-chunk-2-1.png" width="364.8" style="display: block; margin: auto;" /></p>
<p> </p>
<p>Again, the residual variance between the three nutrient types is different. The PO<sub>3</sub> nutrient appears to have the smallest variance whereas the NO<sub>3</sub> nutrient has the largest variance. Both of these plots suggest that the cause of our heterogeneity of variance is both the <code>fbiomass</code> and <code>fnutrient</code> variables. Therefore we need fit a model that allows for different variances in each of our <code>fbiomass</code> and <code>fnutrient</code> variables. To do this we will fit a Generalised Least Squares model using the <code>gls()</code> function from the <code>nlme</code> package.</p>
<p> </p>
<p>7. Import the <code>nlme</code> package into R.</p>
<p> </p>
<p>You will see that I have already done this at the top of this Rmarkdown document using the <code>library()</code> function. It’s good practice to import all the packages required for a particular analysis near the start of your script.</p>
<p> </p>
<p>8. Use the <code>gls()</code> function from the <code>nlme</code> package without any variance covariates to refit your linear model specified above (the model you fitted using the <code>lm()</code> function). This GLS model with no variance structure is equivalent to a standard linear model. You will use this GLS model to compare with models you subsequently fit. If you are not convinced that these two models are equivalent then compare the output from both models (and replot the residuals if you’re still not convinced!). Why do you need to refit this model using the <code>gls()</code> function? (Hint: take a look at the AICs from both models).</p>
<p> </p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>nereis.gls1 &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, </span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>Comparing the AICs from the model fitted with the <code>lm()</code> function and the model fitted using the <code>gls()</code> function.</p>
<p> </p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">AIC</span>(nereis.lm)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">## [1] 105.497</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw">AIC</span>(nereis.gls1)</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">## [1] 109.6412</span></span></code></pre></div>
<p> </p>
<p>As you can see the AICs are different between these two equivalent models. Don’t be fooled though, this is because the AICs are calculated slightly differently for <code>lm</code> and <code>gls</code> class objects so you cannot use them to compare <code>lm</code> models with <code>gls</code> models (that’s why we need to refit our linear model using the <code>gls()</code> function).</p>
<p> </p>
<p>9. With reference to the residual plots you created above, fit models with different variance covariate structures to account for the heterogeneity of variance you identified previously. You will first need to decide which variance structure to use (and which R function to use). I suggest that you start with a simple variance structure and then build up to a more complicated structure. Remember to use the <code>weights =</code> argument with the <code>gls()</code> function to specify your variance structure. Use the <code>AIC()</code> function to compare each of your models with different variance structures. Identify the model with the most appropriate variance covariate structure. Describe and justify your process in your Rmarkdown document.</p>
<p>Let’s first use the <code>fbiomass</code> variable as our variance covariate as our residual plots suggested substantial residual heterogeneity between biomass levels. First we will specify the variance structure using the <code>varIdent()</code> function (as our variance covariate is a categorical variable) and then include this in our <code>gls</code> model using the <code>weights =</code> argument.</p>
<p> </p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>vf1 &lt;-<span class="st"> </span><span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>fbiomass)</span>
<span id="cb14-2"><a href="#cb14-2"></a>nereis.gls2 &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, </span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="dt">weights =</span> vf1, <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>Alternatively you can include the variance structure directly when using the <code>gls()</code> function.</p>
<p> </p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>nereis.gls2 &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, </span>
<span id="cb15-2"><a href="#cb15-2"></a>    <span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>fbiomass), <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>These two are equivalent but I prefer the first method.</p>
<p>Now we can compare our linear model fitted with the <code>gls()</code> function (<code>nereis.gls1</code>) with our model allowing for different variances per biomass level (<code>nereis.gls2</code>).</p>
<p> </p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">AIC</span>(nereis.gls1, nereis.gls2)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">##             df      AIC</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">## nereis.gls1 16 109.6412</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">## nereis.gls2 20 110.6647</span></span></code></pre></div>
<p> </p>
<p>That’s strange, the model estimating different variances per biomass level has a higher AIC value compared to our linear model indicating a poorer fit. Why might this be? We get a clue by looking at the degrees of freedom (df) column in the output of the <code>AIC()</code> function. You can see that we are estimating 4 more parameters for our <code>nereis.gls2</code> model (df = 20) compared to our linear model <code>nereis.gls1</code> (df = 16). As AIC is a measure of goodness of fit which is penalised by the number of parameters estimated this suggests that the improvement in goodness of fit for our <code>nereis.gls2</code> model is not large enough to compensate for the higher number of parameters estimated.</p>
<p>OK, let try to fit another model but this time allow for the variances to differ between <code>fnutrient</code> levels.</p>
<p> </p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>vf2 &lt;-<span class="st"> </span><span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>fnutrient)</span>
<span id="cb17-2"><a href="#cb17-2"></a>nereis.gls3 &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, </span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="dt">weights =</span> vf2, <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>And once again compare all models using AIC.</p>
<p> </p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">AIC</span>(nereis.gls1, nereis.gls2, nereis.gls3)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">##             df      AIC</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">## nereis.gls1 16 109.6412</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">## nereis.gls2 20 110.6647</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">## nereis.gls3 18 106.4491</span></span></code></pre></div>
<p> </p>
<p>So, the model allowing for different variances per <code>fnutrient</code> level appears to be our best model so far.</p>
<p>Now let’s fit a final model which estimates a separate variance for each <code>fbiomass</code> and <code>fnutrient</code> combination (note: this is quite a lot of parameters given the level of replication in our dataset!).</p>
<p> </p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>vf3 &lt;-<span class="st"> </span><span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>fnutrient <span class="op">*</span><span class="st"> </span>fbiomass)</span>
<span id="cb19-2"><a href="#cb19-2"></a>nereis.gls4 &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, </span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="dt">weights =</span> vf3, <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>And again compare all models with AIC.</p>
<p> </p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">AIC</span>(nereis.gls1, nereis.gls2, nereis.gls3, nereis.gls4)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">##             df      AIC</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">## nereis.gls1 16 109.6412</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">## nereis.gls2 20 110.6647</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">## nereis.gls3 18 106.4491</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">## nereis.gls4 30 100.2198</span></span></code></pre></div>
<p> </p>
<p>This suggests that the model with both <code>fbiomass</code> and <code>fnutrient</code> as variance covariates (<code>nereis.gls4</code>) is by far the best model (lots of parameters estimated though).</p>
<p> </p>
<p>10. Now that your model has the optimal variance covariate structure it’s time to perform model selection to identify the optimal fixed effects structure. To do this you will have to refit your optimal model (in terms of variance structure) using maximum likelihood estimation (ML) rather than the default restricted maximum likelihood estimation (REML). To do this use the argument <code>method = "ML"</code> with the <code>gls()</code> function.</p>
<p> </p>
<p>OK, now we have our model with the optimal variance covariate structure, we need to identify the model with the best fixed effects structure. We will use our <code>nereis.gls4</code> model as a starting point but first we need to refit our model using maximum likelihood (ML) rather than restricted maximum likelihood (REML) before we perform model selection on our fixed effects.</p>
<p> </p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>nereis.gls4.ml &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, </span>
<span id="cb21-2"><a href="#cb21-2"></a>    <span class="dt">weights =</span> vf3, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>, <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>11. Perform model selection using AIC to compare model fit. Select the model with the most appropriate fixed effects structure. Describe this process in your R markdown document. If you are feeling adventurous (this is optional!) you can also perform model selection by comparing nested models using likelihood ratio tests (using the <code>anova()</code> function). Does this result in the same final model?</p>
<p> </p>
<p>First we will fit a model without the interaction term <code>fbiomass:fnutrient</code></p>
<p> </p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>nereis.gls5.ml &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">+</span><span class="st"> </span>fnutrient, </span>
<span id="cb22-2"><a href="#cb22-2"></a>    <span class="dt">weights =</span> vf3, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>, <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>And compare this model (<code>nereis.gls5.ml</code>) with the model including the interaction term (<code>nereis.gls4.ml</code>) using AIC.</p>
<p> </p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">AIC</span>(nereis.gls4.ml, nereis.gls5.ml)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">##                df      AIC</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">## nereis.gls4.ml 30 77.36504</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">## nereis.gls5.ml 22 81.12361</span></span></code></pre></div>
<p> </p>
<p>A difference in AIC of 3.76 suggests that the model including the interaction term between <code>fbiomass</code> and <code>fnutrient</code> is our optimal model (<code>nereis.gls4.ml</code>). In other words, when we remove the interaction term from the model the AIC increases from 77.37 to 81.12 and therefore we prefer the model including the interaction term. The good news is that no more model selection is required!!</p>
<p> </p>
<p>As the <code>nereis.gls5.ml</code> is nested within the <code>nereis.gls4.ml</code> model we can (as an optional extra!) compare these models using a likelihood ratio test using the <code>anova()</code> function.</p>
<p> </p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">anova</span>(nereis.gls4.ml, nereis.gls5.ml)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">##                Model df      AIC      BIC     logLik   Test  L.Ratio p-value</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">## nereis.gls4.ml     1 30 77.36504 131.5649  -8.682522                        </span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">## nereis.gls5.ml     2 22 81.12361 120.8702 -18.561806 1 vs 2 19.75857  0.0113</span></span></code></pre></div>
<p> </p>
<p>A <em>p-value</em> of 0.011 suggests that the interaction term should not be dropped. Therefore, the model selection based on AIC and the model selection based on a likelihood ratio test results in the same final model (this might not always be the case!).</p>
<p> </p>
<p>12. Once you have your model with optimal variance covariate and fixed effects structures refit this model using REML. This is your final model.</p>
<p> </p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>nereis.gls.final &lt;-<span class="st"> </span><span class="kw">gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, </span>
<span id="cb25-2"><a href="#cb25-2"></a>    <span class="dt">weights =</span> vf3, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">data =</span> nereis)</span></code></pre></div>
<p> </p>
<p>Note: For clarity, I have included the <code>method = "REML"</code> argument when using the <code>gls()</code> function this time although this is not strictly necessary as REML is the default value for this argument (see the help file for the <code>gls()</code> function for additional information).</p>
<p> </p>
<p>13. Extract the normalised (variance scaled) residuals and fitted values from your final model. Plot the normalised residuals against the fitted values. Can you assume homogeneity of residual variance now? Also plot your normalised residuals against each of your explanatory variables? Comment on the model assumptions and contrast these with the naive linear model.</p>
<p> </p>
<p>First lets extract the normalised residuals from our final model using the <code>resid()</code> function including the argument <code>type = normalized</code> and the fitted values using the <code>fitted()</code> function.</p>
<p> </p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>nereis.res1 &lt;-<span class="st"> </span><span class="kw">resid</span>(nereis.gls.final, <span class="dt">type =</span> <span class="st">&quot;normalized&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>nereis.fit1 &lt;-<span class="st"> </span><span class="kw">fitted</span>(nereis.gls.final)</span></code></pre></div>
<p> </p>
<p>And now create the plot</p>
<p> </p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">plot</span>(nereis.fit1, nereis.res1, <span class="dt">ylab =</span> <span class="st">&quot;normalised residuals&quot;</span>, </span>
<span id="cb27-2"><a href="#cb27-2"></a>    <span class="dt">xlab =</span> <span class="st">&quot;fitted values&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/q13b-1.png" width="384" style="display: block; margin: auto;" /></p>
<p> </p>
<p>This looks a lot better than the equivalent plot from the first linear model we fitted (go back and take a look). It appears that the assumption of homogeneity of residual variance is now satisfied. An easier (but perhaps less transparent) way to create this plot (not shown) is :</p>
<p> </p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">plot</span>(nereis.gls.final, <span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="kw">fitted</span>(.))</span></code></pre></div>
<p> </p>
<p>We should also plot our normalised residual against each of our explanatory variables.</p>
<p> </p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">plot</span>(nereis<span class="op">$</span>fbiomass, nereis.res1)</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="kw">plot</span>(nereis<span class="op">$</span>fnutrient, nereis.res1)</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p> </p>
<p>Again, these look much better than for our naive linear model.</p>
<p>As before, we can use a short cut to obtain similar plots (not shown):</p>
<p> </p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">plot</span>(nereis.gls.final, fnutrient <span class="op">~</span><span class="st"> </span><span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw">plot</span>(nereis.gls.final, fbiomass <span class="op">~</span><span class="st"> </span><span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>))</span></code></pre></div>
<p> </p>
<p>14. Now (and only now!) you can go ahead and interpret the the output from your final model (use the <code>anova()</code> and <code>summary()</code> functions). Summarise your interpretation in your R markdown document.</p>
<p> </p>
<p>Display the ANOVA table using the <code>anova()</code> function. This highlights the significant interaction term between <code>fbiomass</code> and <code>fnutrient</code> variables. In fact, notice the interaction term <em>p-value</em> is the same (within rounding error) as the one obtained using the likelihood ratio test above.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">anova</span>(nereis.gls.final)</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co">## Denom. DF: 30 </span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">##                    numDF   F-value p-value</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">## (Intercept)            1 119.15883  &lt;.0001</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">## fbiomass               4  49.67333  &lt;.0001</span></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="co">## fnutrient              2  22.93364  &lt;.0001</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">## fbiomass:fnutrient     8   3.01002  0.0133</span></span></code></pre></div>
<p> </p>
<p>To display the parameter estimates we use the <code>summary()</code> function. Prepare for voluminous output! Take note of the <code>Variance function:</code> section which displays the multiplication factors for each of our treatment group (<code>fbiomass</code> and <code>fnutrient</code>) combinations. We can use these multiplication factors to multiply the residual standard error from the model, (0.0318), to give us our group standard deviations and then square these values to give us our group level variance estimates (i.e. for the NH4<code>*</code>0.5 group: (30.48 x 0.0318)<sup>2</sup> = 0.939). The parameter estimates are provided in the form of treatment contrasts (remember those!) which will take you quite a while to work through.</p>
<p> </p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">summary</span>(nereis.gls.final)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co">## Generalized least squares fit by REML</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co">##   Model: concentration ~ fbiomass * fnutrient </span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co">##   Data: nereis </span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co">##        AIC      BIC    logLik</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="co">##   100.2198 142.2558 -20.10992</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co">## </span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="co">## Variance function:</span></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="co">##  Structure: Different standard deviations per stratum</span></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co">##  Formula: ~1 | fnutrient * fbiomass </span></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="co">##  Parameter estimates:</span></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="co">##     NH4*0   NH4*0.5     NH4*1   NH4*1.5     NH4*2     NO3*0   NO3*0.5     NO3*1   NO3*1.5     NO3*2     PO3*0   PO3*0.5 </span></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="co">##  1.000000 30.490662 10.433659  9.512390 43.814615 41.570039 22.368561 16.553389 18.043296 15.284863  1.196884 15.889925 </span></span>
<span id="cb32-14"><a href="#cb32-14"></a><span class="co">##     PO3*1   PO3*1.5     PO3*2 </span></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="co">##  6.693475  5.688974 15.730721 </span></span>
<span id="cb32-16"><a href="#cb32-16"></a><span class="co">## </span></span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="co">## Coefficients:</span></span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="co">##                              Value Std.Error   t-value p-value</span></span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="co">## (Intercept)               0.086667 0.0183334  4.727261  0.0001</span></span>
<span id="cb32-20"><a href="#cb32-20"></a><span class="co">## fbiomass0.5               0.946667 0.5592974  1.692600  0.1009</span></span>
<span id="cb32-21"><a href="#cb32-21"></a><span class="co">## fbiomass1                 0.807567 0.1921608  4.202557  0.0002</span></span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="co">## fbiomass1.5               1.113000 0.1753553  6.347115  0.0000</span></span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="co">## fbiomass2                 2.595333 0.8034792  3.230119  0.0030</span></span>
<span id="cb32-24"><a href="#cb32-24"></a><span class="co">## fnutrientNO3              2.413333 0.7623398  3.165692  0.0035</span></span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="co">## fnutrientPO3              0.041733 0.0285938  1.459524  0.1548</span></span>
<span id="cb32-26"><a href="#cb32-26"></a><span class="co">## fbiomass0.5:fnutrientNO3 -0.501667 1.0304438 -0.486845  0.6299</span></span>
<span id="cb32-27"><a href="#cb32-27"></a><span class="co">## fbiomass1:fnutrientNO3   -1.342567 0.8425268 -1.593500  0.1215</span></span>
<span id="cb32-28"><a href="#cb32-28"></a><span class="co">## fbiomass1.5:fnutrientNO3 -1.858000 0.8491174 -2.188154  0.0366</span></span>
<span id="cb32-29"><a href="#cb32-29"></a><span class="co">## fbiomass2:fnutrientNO3   -3.490333 1.1423352 -3.055437  0.0047</span></span>
<span id="cb32-30"><a href="#cb32-30"></a><span class="co">## fbiomass0.5:fnutrientPO3 -0.348133 0.6309993 -0.551717  0.5852</span></span>
<span id="cb32-31"><a href="#cb32-31"></a><span class="co">## fbiomass1:fnutrientPO3   -0.279900 0.2290546 -1.221980  0.2312</span></span>
<span id="cb32-32"><a href="#cb32-32"></a><span class="co">## fbiomass1.5:fnutrientPO3 -0.586533 0.2052049 -2.858281  0.0077</span></span>
<span id="cb32-33"><a href="#cb32-33"></a><span class="co">## fbiomass2:fnutrientPO3   -1.906533 0.8539516 -2.232601  0.0332</span></span>
<span id="cb32-34"><a href="#cb32-34"></a><span class="co">## </span></span>
<span id="cb32-35"><a href="#cb32-35"></a><span class="co">##  Correlation: </span></span>
<span id="cb32-36"><a href="#cb32-36"></a><span class="co">##                          (Intr) fbm0.5 fbmss1 fbm1.5 fbmss2 fntNO3 fntPO3 f0.5:N f1:NO3 f1.5:N f2:NO3 f0.5:P f1:PO3 f1.5:P</span></span>
<span id="cb32-37"><a href="#cb32-37"></a><span class="co">## fbiomass0.5              -0.033                                                                                           </span></span>
<span id="cb32-38"><a href="#cb32-38"></a><span class="co">## fbiomass1                -0.095  0.003                                                                                    </span></span>
<span id="cb32-39"><a href="#cb32-39"></a><span class="co">## fbiomass1.5              -0.105  0.003  0.010                                                                             </span></span>
<span id="cb32-40"><a href="#cb32-40"></a><span class="co">## fbiomass2                -0.023  0.001  0.002  0.002                                                                      </span></span>
<span id="cb32-41"><a href="#cb32-41"></a><span class="co">## fnutrientNO3             -0.024  0.001  0.002  0.003  0.001                                                               </span></span>
<span id="cb32-42"><a href="#cb32-42"></a><span class="co">## fnutrientPO3             -0.641  0.021  0.061  0.067  0.015  0.015                                                        </span></span>
<span id="cb32-43"><a href="#cb32-43"></a><span class="co">## fbiomass0.5:fnutrientNO3  0.018 -0.543 -0.002 -0.002  0.000 -0.740 -0.011                                                 </span></span>
<span id="cb32-44"><a href="#cb32-44"></a><span class="co">## fbiomass1:fnutrientNO3    0.022 -0.001 -0.228 -0.002  0.000 -0.905 -0.014  0.669                                          </span></span>
<span id="cb32-45"><a href="#cb32-45"></a><span class="co">## fbiomass1.5:fnutrientNO3  0.022 -0.001 -0.002 -0.207  0.000 -0.898 -0.014  0.664  0.812                                   </span></span>
<span id="cb32-46"><a href="#cb32-46"></a><span class="co">## fbiomass2:fnutrientNO3    0.016 -0.001 -0.002 -0.002 -0.703 -0.667 -0.010  0.494  0.604  0.599                            </span></span>
<span id="cb32-47"><a href="#cb32-47"></a><span class="co">## fbiomass0.5:fnutrientPO3  0.029 -0.886 -0.003 -0.003 -0.001 -0.001 -0.045  0.481  0.001  0.001  0.000                     </span></span>
<span id="cb32-48"><a href="#cb32-48"></a><span class="co">## fbiomass1:fnutrientPO3    0.080 -0.003 -0.839 -0.008 -0.002 -0.002 -0.125  0.001  0.191  0.002  0.001  0.006              </span></span>
<span id="cb32-49"><a href="#cb32-49"></a><span class="co">## fbiomass1.5:fnutrientPO3  0.089 -0.003 -0.009 -0.855 -0.002 -0.002 -0.139  0.002  0.002  0.176  0.001  0.006  0.017       </span></span>
<span id="cb32-50"><a href="#cb32-50"></a><span class="co">## fbiomass2:fnutrientPO3    0.021 -0.001 -0.002 -0.002 -0.941 -0.001 -0.033  0.000  0.000  0.000  0.662  0.002  0.004  0.005</span></span>
<span id="cb32-51"><a href="#cb32-51"></a><span class="co">## </span></span>
<span id="cb32-52"><a href="#cb32-52"></a><span class="co">## Standardized residuals:</span></span>
<span id="cb32-53"><a href="#cb32-53"></a><span class="co">##         Min          Q1         Med          Q3         Max </span></span>
<span id="cb32-54"><a href="#cb32-54"></a><span class="co">## -1.15469760 -0.85036560  0.05707306  0.79914114  1.13019396 </span></span>
<span id="cb32-55"><a href="#cb32-55"></a><span class="co">## </span></span>
<span id="cb32-56"><a href="#cb32-56"></a><span class="co">## Residual standard error: 0.03175435 </span></span>
<span id="cb32-57"><a href="#cb32-57"></a><span class="co">## Degrees of freedom: 45 total; 30 residual</span></span>
<span id="cb32-58"><a href="#cb32-58"></a></span>
<span id="cb32-59"><a href="#cb32-59"></a><span class="co"># if you want less output you can use the slightly hacky</span></span>
<span id="cb32-60"><a href="#cb32-60"></a><span class="co"># code to return the variance inflation factors</span></span>
<span id="cb32-61"><a href="#cb32-61"></a><span class="co"># summary(nereis.gls.final)$modelStruct$varStruct</span></span>
<span id="cb32-62"><a href="#cb32-62"></a></span>
<span id="cb32-63"><a href="#cb32-63"></a><span class="co"># and the summary table of parameter estimates</span></span>
<span id="cb32-64"><a href="#cb32-64"></a><span class="co"># summary(nereis.gls.final)$tTable</span></span></code></pre></div>
<p> </p>
<p>As with most things in life, things are often clearer if we draw a picture. Let’s create a graph of our predicted values along with 95 % confidence intervals. There are many ways to do this (including using the <code>predict()</code> function) but perhaps an easier way is to use the <code>allEffects()</code> function from the <code>effects</code> package (install this if required). See <code>?allEffects</code> for more details of this function.</p>
<p> </p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>effs &lt;-<span class="st"> </span><span class="kw">allEffects</span>(nereis.gls.final, <span class="dt">se =</span> <span class="kw">list</span>(<span class="dt">level =</span> <span class="fl">0.95</span>))</span>
<span id="cb33-2"><a href="#cb33-2"></a></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="kw">plot</span>(effs, <span class="dt">lines =</span> <span class="kw">list</span>(<span class="dt">multiline =</span> <span class="ot">TRUE</span>, <span class="dt">lwd =</span> <span class="fl">0.8</span>), <span class="dt">symbols =</span> <span class="kw">list</span>(<span class="dt">pch =</span> <span class="dv">1</span>), </span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="dt">confint =</span> <span class="kw">list</span>(<span class="dt">style =</span> <span class="st">&quot;bars&quot;</span>), <span class="dt">lattice =</span> <span class="kw">list</span>(<span class="dt">key.args =</span> <span class="kw">list</span>(<span class="dt">border =</span> <span class="ot">FALSE</span>, </span>
<span id="cb33-5"><a href="#cb33-5"></a>        <span class="dt">title =</span> <span class="st">&quot;Nutrient&quot;</span>)), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;polychaete biomass (g)&quot;</span>, </span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="dt">ylab =</span> <span class="st">&quot;nutrient concentration mg/l&quot;</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/q14c-1.png" width="480" style="display: block; margin: auto;" /></p>
<p> </p>
<p>I prefer the following plot as I find it clearer.</p>
<p> </p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">plot</span>(effs, <span class="dt">lines =</span> <span class="kw">list</span>(<span class="dt">lwd =</span> <span class="fl">0.8</span>), <span class="dt">symbols =</span> <span class="kw">list</span>(<span class="dt">pch =</span> <span class="dv">1</span>), </span>
<span id="cb34-2"><a href="#cb34-2"></a>    <span class="dt">confint =</span> <span class="kw">list</span>(<span class="dt">style =</span> <span class="st">&quot;bars&quot;</span>), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;polychaete biomass (g)&quot;</span>, </span>
<span id="cb34-3"><a href="#cb34-3"></a>    <span class="dt">ylab =</span> <span class="st">&quot;nutrient concentration mg/l&quot;</span>, <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb34-4"><a href="#cb34-4"></a>        <span class="dv">3</span>))</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/q14d-1.png" width="384" style="display: block; margin: auto;" /></p>
<p> </p>
<p>These plots confirm our intuition. The nutrient concentration does change with polychaete biomass but this change appears to be dependent on the type of nutrient measured. For PO<sub>3</sub> the nutrient concentration remains at a relatively low concentration regardless of polychaete biomass. For NO<sub>3</sub> the concentration reduces as polychaete biomass increases whereas for NH<sub>4</sub> the concentration increases with an increase in biomass.</p>
<p> </p>
<p>That’s more or less it. Well done and congratulations! </p>
<div id="bonus-code" class="section level4">
<h4>Bonus code!</h4>
<p> </p>
<p>An alternative method to create a boxplot using the <code>ggplot()</code> function from the <code>ggplot2</code> package. We haven’t introduced you to <code>ggplot2</code> but if you are interested see <a href="https://intro2r.com/graphics-r.html">Chapter 5</a> of our ‘Introduction to R’ book.</p>
<p> </p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">ggplot</span>(nereis, <span class="kw">aes</span>(<span class="dt">x =</span> fbiomass, <span class="dt">y =</span> concentration, <span class="dt">fill =</span> fnutrient)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;polychaete biomass (g)&quot;</span>, </span>
<span id="cb35-3"><a href="#cb35-3"></a>    <span class="dt">y =</span> <span class="st">&quot;concentration (mg/l)&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Biomass&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/bonus1-1.png" width="672" /></p>
<p> </p>
<p>An alternative way to calculate and plot the predicted mean concentration for each group and associated 95% confidence intervals. This method requires you to install the <code>rms</code> package, use the <code>Gls()</code> function (note the capital G) to fit your model and the <code>Predict()</code> function (notice the capital P) to estimate the group means and approximate confidence intervals. Finally <code>ggplot()</code> is used to plot these values.</p>
<p> </p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">library</span>(rms)</span>
<span id="cb36-2"><a href="#cb36-2"></a>f &lt;-<span class="st"> </span><span class="kw">Gls</span>(concentration <span class="op">~</span><span class="st"> </span>fbiomass <span class="op">*</span><span class="st"> </span>fnutrient, <span class="dt">weights =</span> vf3, </span>
<span id="cb36-3"><a href="#cb36-3"></a>    <span class="dt">data =</span> nereis)</span>
<span id="cb36-4"><a href="#cb36-4"></a>w &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">Predict</span>(f, <span class="dt">fbiomass =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;0.5&quot;</span>, <span class="st">&quot;1&quot;</span>, </span>
<span id="cb36-5"><a href="#cb36-5"></a>    <span class="st">&quot;1.5&quot;</span>, <span class="st">&quot;2&quot;</span>), <span class="dt">fnutrient =</span> <span class="kw">c</span>(<span class="st">&quot;NH4&quot;</span>, <span class="st">&quot;NO3&quot;</span>, <span class="st">&quot;PO3&quot;</span>)))</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="kw">ggplot</span>(w, <span class="kw">aes</span>(<span class="dt">x =</span> fbiomass, <span class="dt">y =</span> yhat, <span class="dt">group =</span> fnutrient, </span>
<span id="cb36-8"><a href="#cb36-8"></a>    <span class="dt">colour =</span> fnutrient)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower, </span>
<span id="cb36-9"><a href="#cb36-9"></a>    <span class="dt">ymax =</span> upper), <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;polychaete biomass (g)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;concentration (mg/l)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="st">    </span><span class="kw">scale_colour_brewer</span>(<span class="dt">name =</span> <span class="st">&quot;nutrient type&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<p><img src="GLS_variance_heterogeneity_report_files/figure-html/bonus2-1.png" width="672" /></p>
<p> </p>
<p>###Session Information</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>xfun<span class="op">::</span><span class="kw">session_info</span>()</span></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.7, RStudio 1.3.957
## 
## Locale: en_GB.UTF-8 / en_GB.UTF-8 / en_GB.UTF-8 / C / en_GB.UTF-8 / en_GB.UTF-8
## 
## Package version:
##   askpass_1.1               assertthat_0.2.1          backports_1.1.8           base64enc_0.1-3          
##   BH_1.72.0.3               boot_1.3-25               callr_3.4.3               carData_3.0-4            
##   checkmate_2.0.0           cli_2.0.2                 clipr_0.7.0               cluster_2.1.0            
##   codetools_0.2-16          colorspace_1.4-1          compiler_3.6.3            conquer_1.0.1            
##   crayon_1.3.4              curl_4.3                  data.table_1.12.8         DBI_1.1.0                
##   desc_1.2.0                digest_0.6.25             dplyr_1.0.1               effects_4.2-0            
##   ellipsis_0.3.1            estimability_1.3          evaluate_0.14             fansi_0.4.1              
##   farver_2.0.3              foreign_0.8-76            formatR_1.7               Formula_1.2-3            
##   generics_0.0.2            ggplot2_3.3.2             glue_1.4.1                graphics_3.6.3           
##   grDevices_3.6.3           grid_3.6.3                gridExtra_2.3             gtable_0.3.0             
##   highr_0.8                 Hmisc_4.4-1               hms_0.5.3                 htmlTable_2.0.1          
##   htmltools_0.5.0           htmlwidgets_1.5.1         httr_1.4.2                insight_0.9.0            
##   isoband_0.2.2             jpeg_0.1-8.1              jsonlite_1.7.0            kableExtra_1.1.0         
##   knitr_1.29                labeling_0.3              lattice_0.20-41           latticeExtra_0.6-29      
##   lifecycle_0.2.0           lme4_1.1-23               magrittr_1.5              markdown_1.1             
##   MASS_7.3-51.6             Matrix_1.2-18             MatrixModels_0.4-1        matrixStats_0.56.0       
##   methods_3.6.3             mgcv_1.8.31               mime_0.9                  minqa_1.2.4              
##   mitools_2.4               multcomp_1.4-13           munsell_0.5.0             mvtnorm_1.1-1            
##   nlme_3.1-148              nloptr_1.2.2.2            nnet_7.3-14               numDeriv_2016.8.1.1      
##   openssl_1.4.2             packrat_0.5.0             pander_0.6.3              parallel_3.6.3           
##   pillar_1.4.6              pkgbuild_1.1.0            pkgconfig_2.0.3           pkgload_1.1.0            
##   png_0.1-7                 polspline_1.1.19          praise_1.0.0              prettyunits_1.1.1        
##   processx_3.4.3            ps_1.3.4                  purrr_0.3.4               quantreg_5.61            
##   R6_2.4.1                  RColorBrewer_1.1-2        Rcpp_1.0.5                RcppArmadillo_0.9.900.2.0
##   RcppEigen_0.3.3.7.0       readr_1.3.1               rlang_0.4.7               rmarkdown_2.3            
##   rms_6.0-1                 rpart_4.1-15              rprojroot_1.3.2           rsconnect_0.8.16         
##   rstudioapi_0.11           rvest_0.3.6               sandwich_2.5-1            scales_1.1.1             
##   selectr_0.4.2             SparseM_1.78              splines_3.6.3             statmod_1.4.34           
##   stats_3.6.3               stringi_1.4.6             stringr_1.4.0             survey_4.0               
##   survival_3.2-3            sys_3.4                   testthat_2.3.2            TH.data_1.0-10           
##   tibble_3.0.3              tidyselect_1.1.0          tinytex_0.25              tools_3.6.3              
##   utf8_1.1.4                utils_3.6.3               vctrs_0.3.2               viridis_0.5.1            
##   viridisLite_0.3.0         webshot_0.5.2             withr_2.2.0               xfun_0.16                
##   xml2_1.3.2                yaml_2.2.1                zoo_1.8-8</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
